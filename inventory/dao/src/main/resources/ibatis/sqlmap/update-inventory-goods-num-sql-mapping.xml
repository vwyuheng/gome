<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="tuan-inventory" >
	
	<!-- 更新分店库存   -->	
    <update id="updateSuppliersInventoryNumberBySiID" parameterClass="com.tuan.inventory.dao.data.GoodsUpdateNumberDO" >
       update jeehe_goods_suppliers_inventory
      <dynamic prepend="set" >
        <isNotNull prepend="," property="leftNum">
			leftNumber =#leftNum:INTEGER#
		</isNotNull>
		<isNotNull prepend="," property="totalNum">
			totalNumber =#totalNum:INTEGER#
		</isNotNull>
      </dynamic>
      where suppliers_id = #id:INTEGER# and `status` = 0  and limit_storage = 1
    </update>
    <!-- 更新选型库存  -->	
    <update id="updateSelectionRelationNumberBySID" parameterClass="com.tuan.inventory.dao.data.GoodsUpdateNumberDO" >
       update jeehe_selection_relation
      <dynamic prepend="set" >
        <isNotNull prepend="," property="leftNum">
			leftNumber =#leftNum:INTEGER#
		</isNotNull>
		<isNotNull prepend="," property="totalNum">
			totalNumber =#totalNum:INTEGER#
		</isNotNull>
      </dynamic>
      where id = #id:INTEGER# and `status` = 0 and limit_storage = 1 
    </update>
    <!-- 更新商品库存   -->	
    <update id="updateGoodsAttributesNumberByGID" parameterClass="com.tuan.inventory.dao.data.GoodsUpdateNumberDO" >
      update jeehe_goods_attribute
      <dynamic prepend="set" >
        <isNotNull prepend="," property="leftNum">
			left_num = #leftNum:INTEGER#
		</isNotNull>
		 <isNotNull prepend="," property="totalNum">
			total_num = #totalNum:INTEGER#
		</isNotNull>
      </dynamic>
      where goods_id = #id:INTEGER#  and limit_storage = 1
    </update>
    
    <!-- 更新物流信息  -->
	<update id="updataGoodsWmsNumByID" parameterClass="com.tuan.inventory.dao.data.GoodsUpdateNumberDO">
		 update jeehe_goods_wms
		<dynamic prepend="set">
			<isNotNull prepend="," property="leftNum">
				left_num =  #leftNum:INTEGER#
      		</isNotNull>
      		<isNotNull prepend="," property="totalNum">
				total_num =  #totalNum:INTEGER#
      		</isNotNull>
		</dynamic>
		where wms_goods_id = #wmsGoodsId:VARCHAR# 
	</update>
	
	 <!-- 更新商品基本信息表-->
	<update id="updataGoodsBaseNumByID" parameterClass="com.tuan.inventory.dao.data.redis.GoodsBaseInventoryDO">
		 update jeehe_inventory_base
		<dynamic prepend="set">
			<isNotNull prepend="," property="baseSaleCount">
				base_sale_count =  #baseSaleCount:INTEGER#
      		</isNotNull>
      		<isNotNull prepend="," property="baseTotalCount">
				base_total_count =  #baseTotalCount:INTEGER#
      		</isNotNull>
		</dynamic>
		where goods_base_id = #goodsBaseId:INTEGER# 
	</update>
<!-- 	<update id="set_sql_model_user"  > -->
<!-- 		set sql_mode='STRICT_TRANS_TABLES' -->
<!-- 	</update> -->
<!-- 	<update id="set_sql_model_sys"  > -->
<!-- 		set sql_mode='NO_AUTO_CREATE_USER' -->
<!-- 	</update> -->
	<update id="updataGoodsNumByID" parameterClass="com.tuan.inventory.dao.data.GoodsUpdateNumberDO">
		 update jeehe_goods
		<dynamic prepend="set">
			<isNotNull prepend="," property="goodsSaleCount">
				sale_count =  #goodsSaleCount:INTEGER#
      		</isNotNull>
		</dynamic>
		where goods_id = #id:BIGINT#
	</update>

</sqlMap>