<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="tuan-inventory" >
	 	
  	 <!-- 商品主体库存信息-->	
	<resultMap id="GoodsInventoryResult" class="com.tuan.inventory.dao.data.redis.GoodsInventoryDO">
	    <result column="goods_id" property="goodsId" jdbcType="BIGINT" />
	    <result column="goods_wms_id" property="wmsId" jdbcType="BIGINT" />
	    <result column="good_selection_ids" property="goodsSelectionIds" jdbcType="VARCHAR" />
	    <result column="user_id" property="userId" jdbcType="BIGINT" />
	    <result column="total_num" property="totalNumber" jdbcType="INTEGER" />
	    <result column="left_num" property="leftNumber" jdbcType="INTEGER" />
	    <result column="limit_storage" property="limitStorage" jdbcType="INTEGER" />
	    <result column="add_goods_selection" property="isAddGoodsSelection" jdbcType="INTEGER" />
	    <result column="direct_consumption" property="isDirectConsumption" jdbcType="INTEGER" />
	    <result column="goods_base_id" property="goodsBaseId" jdbcType="BIGINT" />
	    <result column="attach_sale" property="waterfloodVal" jdbcType="INTEGER" />
	    <result column="goods_sale_count" property="goodsSaleCount" jdbcType="INTEGER" />
	 </resultMap>
	
	<!-- 通过商品ID查询非选型实物商品的库存  -->	
	<select id="selectRedisInventoryByGoodsId" resultMap="GoodsInventoryResult"  parameterClass="java.lang.Long">
	 SELECT ga.goods_id,gd.goods_base_id,IFNULL(ga.goods_wms_id,0) as goods_wms_id,ga.good_type_ids AS good_selection_ids,0 AS user_id,ga.total_num,ga.left_num,IFNULL(gd.sale_count,0) AS goods_sale_count,ga.limit_storage ,ga.add_goods_selection,ga.direct_consumption,gd.plus_num AS attach_sale
		from jeehe_goods_attribute ga,jeehe_goods gd WHERE ga.goods_id=gd.goods_id  AND ga.goods_id = #goodsId:BIGINT#
	</select>
	
	<!-- 更加物流编码查询商品库存信息 -->
	<select id="selectInventoryListByWmsGoodsId" resultMap="GoodsInventoryResult"  parameterClass="java.lang.String">
	 SELECT ga.goods_id,gd.goods_base_id,IFNULL(ga.goods_wms_id,0) AS goods_wms_id,ga.good_type_ids AS good_selection_ids,0 AS user_id,ga.total_num,ga.left_num,IFNULL(gd.sale_count,0) AS goods_sale_count,ga.limit_storage ,ga.add_goods_selection,ga.direct_consumption,gd.plus_num AS attach_sale
	from jeehe_goods_attribute ga ,jeehe_goods gd,jeehe_goods_wms wms WHERE ga.goods_id=gd.goods_id AND ga.goods_wms_id = wms.id and wms.wms_goods_id = #wmsGoodsId:VARCHAR#
	</select>
	
	
</sqlMap>